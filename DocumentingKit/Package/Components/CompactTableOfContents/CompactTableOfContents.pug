include CompactTableOfContents.class.pug


mixin CompactTableOfContents--YDF_DK(localizedRouting, options, iterationData)

  if localizedRouting

    -
      options = options ?? {};
      iterationData = iterationData ?? {
        currentDepthLevel__numerationFrom0: -1,
        currentRouteSegments: []
      }

    ul.CompactTableOfContents--YDF_DK&attributes(attributes)

      each metadata, key in localizedRouting

        -
          iterationData.currentDepthLevel__numerationFrom0++;
          iterationData.currentRouteSegments[iterationData.currentDepthLevel__numerationFrom0] = key;
          const route = iterationData.currentRouteSegments.join(".");


        li.CompactTableOfContents--YDF_DK-Item

          -

            let children;

            if (isNotUndefined(metadata.$children)) {
              children = metadata.$children;
            } else if (isNotUndefined(metadata.$sectioning) && metadata.$mustDisplayDirectDecadentSectioning) {
              children = metadata.$sectioning;
            }


          if children

            button.CompactTableOfContents--YDF_DK-Item-CollapsingToggle(
              type="button"
              aria-label="Collapse"
            ): +Triangle__Upward__Circled__Filled--YDF_Icon.CompactTableOfContents--YDF_DK-Item-CollapsingToggle-Icon

          if metadata.$URI


            -

              const isCurrentRoute = route === RoutingEmulator.currentRoute;
              const linkModifierCSS_CLasses = isCurrentRoute ? [ "CompactTableOfContents--YDF_DK-Item-Link__Current" ] : [];


            a.CompactTableOfContents--YDF_DK-Item-Link(
              href=metadata.$URI
              class=linkModifierCSS_CLasses
              aria-current=isCurrentRoute ? "page" : null
            )!= metadata.$tableOfContentsTitle

          else

            span.CompactTableOfContents--YDF_DK-Item-Title!= metadata.$tableOfContentsTitle

          if children

            +CompactTableOfContents--YDF_DK(children, options, iterationData)

        -
          iterationData.currentDepthLevel__numerationFrom0--;
          iterationData.currentRouteSegments.splice(-1, 1);
